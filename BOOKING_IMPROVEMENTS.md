# ๐ ุชุนุฏููุงุช Booking - ูุงุฆูุฉ ุงูููุงู

## โ ุชู ุฅูุฌุงุฒู

### 1. ุงูุชุญูู ูู ุงููุจูุบ ุงููุฏููุน ูุจู ุงูุญูุธ
- โ ุชุญุฏูุซ `validate_paid_amount()` ูู booking_utils.py
- โ ุงููุจูุบ ุงููุฏููุน >= ุงูุนุฑุจูู OR = ุงููุจูุบ ุงูุฅุฌูุงูู
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ

---

## ๐ ููุฏ ุงูุชูููุฐ

### 2. ุฅุธูุงุฑ ุณุนุฑ ุงูุณุงุนุฉ ุจุนุฏ ุงูุฎุตู ูู ุฌุฏูู ุงูุฎุฏูุงุช
**ุงููุดููุฉ ุงูุญุงููุฉ:**
- ุนูุฏ ุชูุนูู Photographer B2Bุ ูุชู ุฅุฎูุงุก ุนููุฏ "ุณุนุฑ ุงูุณุงุนุฉ ุจุนุฏ ุงูุฎุตู"
- ุงูุณุนุฑ ุจุนุฏ ุงูุฎุตู = ุงูุณุนุฑ ูุจู ุงูุฎุตู (ูุง ูุทุจู ุงูุฎุตู)

**ุงูุญู ุงููุทููุจ:**
- ุฅุธูุงุฑ ุงูุนููุฏ ุฏุงุฆูุงู (ุนุฏู ุฅุฎูุงุฆู)
- ุญุณุงุจ ุงูุณุนุฑ ุงููุฎูุถ ุจุดูู ุตุญูุญ ุนูุฏ:
  1. ุงุฎุชูุงุฑ ุงููุตูุฑ
  2. ุชูุนูู Photographer B2B
  
**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**
- `booking.js` - ุฅุฒุงูุฉ ููุทู ุงูุฅุฎูุงุก
- `booking.py` - ุชุญุฏูุซ ุญุณุงุจ ุงูุณุนุฑ ุงููุฎูุถ

---

## ๐ ุงููุชุจูู

### 3. ุฑุณุงูุฉ ุชุญุฐูุฑ ููุงุฏ ุงูุจุงูุฉ
**ุงููุทููุจ:**
- ุชุบููุฑ ุฑุณุงูุฉ "ุชู ุงุณุชููุงุฏ ุฌููุน ุณุงุนุงุช ุงูุจุงูุฉ" ูู `frappe.throw()` ุฅูู `frappe.msgprint()`
- ููุน ุงูุฑุณุงูุฉ: indicator='orange' ุฃู 'red'
- ุงูููุถุน: ูู ุงูุฃุณูู (alert-container-message)

**ุงููููุงุช:**
- `booking.py` - ุชุญุฏูุซ validation

---

### 4. ุญุณุงุจ ุงูุณุงุนุงุช ุงููุชุจููุฉ ุชููุงุฆูุงู
**ุงููุทููุจ:**
ุนูุฏ ุงุฎุชูุงุฑ ุงูุจุงูุฉ:
1. ููุก `remaining_hours` ุจูููุฉ ุฅุฌูุงูู ุณุงุนุงุช ุงูุจุงูุฉ (`package.total_hours`)
2. ุนูุฏ ุฅุถุงูุฉ ุชุงุฑูุฎ ุญุฌุฒ:
   - ุญุณุงุจ ุนุฏุฏ ุงูุณุงุนุงุช ูู `start_time` ู `end_time`
   - ูุถุน ุงูุนุฏุฏ ูู ุญูู `hours` ุฏุงุฎู `package_booking_dates`
3. ุฌูุน ูู ุงูุณุงุนุงุช ุงููุฎุชุงุฑุฉ ููุถุนูุง ูู `used_hours`
4. ุทุฑุญ `used_hours` ูู ุฅุฌูุงูู ุณุงุนุงุช ุงูุจุงูุฉ = `remaining_hours`
5. ุนูุฏ `remaining_hours = 0`ุ ููุน ุฅุถุงูุฉ ุชูุงุฑูุฎ ุฌุฏูุฏุฉ

**ุงููููุงุช:**
- `booking.py` - ุฏุงูุฉ `compute_package_hours_usage()`
- `booking.js` - ุญุณุงุจ ุงูุณุงุนุงุช ุนูุฏ ุชุบููุฑ start_time/end_time

---

### 5. ุญุณุงุจ ุงููุจูุบ ุงูุฅุฌูุงูู ูู ุฌุฏูู ุฎุฏูุงุช ุงูุจุงูุฉ
**ุงููุทููุจ:**
- ุงููุจูุบ ุงูุฅุฌูุงูู ููู ุตู = `quantity ร hourly_rate`
- ุนูุฏ ุชูุนูู B2B:
  - ููุฎุฏูุงุช ุงูููุฌูุฏุฉ ูู ุงููุตูุฑ ูุงููุณููุญ ุจุฎุตููุง:
    - ุงููุจูุบ ุงูุฅุฌูุงูู = `quantity ร discounted_hourly_rate`
  - ููุฎุฏูุงุช ุงูุฃุฎุฑู:
    - ุงููุจูุบ ุงูุฅุฌูุงูู = `quantity ร hourly_rate`

**ุงููููุงุช:**
- `booking_utils.py` - ุฏุงูุฉ `calculate_services_with_photographer_discount()`
- `booking.py` - ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุนูุฏ ุงูุชุบููุฑ

---

## ๐ ุงูุชูุงุตูู ุงููููุฉ

### ุญููู Booking ุงููุชุฃุซุฑุฉ:
```
- booking_type (Service/Package)
- photographer
- photographer_b2b (Check)
- package
- remaining_hours (Float)
- used_hours (Float)  
- total_booked_hours (Float)
- package_booking_dates (Table)
- package_services_table (Table)
- deposit_amount
- paid_amount
- total_amount (Service)
- total_amount_package (Package)
```

### ุฌุฏูู package_booking_dates:
```
- booking_date
- start_time
- end_time
- hours (ุญุณุงุจ ุชููุงุฆู)
```

### ุฌุฏูู package_services_table:
```
- service
- quantity
- hourly_rate
- discounted_hourly_rate (ุฌุฏูุฏ ุฃู ููุฌูุฏ)
- total_amount (ุญุณุงุจ ุชููุงุฆู)
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุชุฑุชูุจ ุงูุนูููุงุช:**
   - ุงุฎุชูุงุฑ ุงูุจุงูุฉ โ ููุก remaining_hours
   - ุงุฎุชูุงุฑ ุงููุตูุฑ โ ุฌูุจ ุงูุฎุฏูุงุช ุงููุณููุญ ุจูุง
   - ุชูุนูู B2B โ ุญุณุงุจ ุงูุฃุณุนุงุฑ ุงููุฎูุถุฉ
   - ุฅุถุงูุฉ ุชูุงุฑูุฎ โ ุญุณุงุจ ุงูุณุงุนุงุช โ ุชุญุฏูุซ remaining_hours

2. **Validation:**
   - ูุจู ุงูุญูุธ: ุงูุชุญูู ูู paid_amount
   - ุนูุฏ ุฅุถุงูุฉ ุชุงุฑูุฎ: ุงูุชุญูู ูู remaining_hours > 0
   - ุนูุฏ ุงูุญูุธ: ุงูุชุญูู ูู ุนุฏู ุชุฌุงูุฒ ุณุงุนุงุช ุงูุจุงูุฉ

3. **UI/UX:**
   - ุฅุธูุงุฑ remaining_hours ุจุดูู ูุงุถุญ
   - ุฑุณุงุฆู ุชุญุฐูุฑ ูุงุถุญุฉ ุนูุฏ ููุงุฏ ุงูุณุงุนุงุช
   - ุชุนุทูู ุฅุถุงูุฉ ุชูุงุฑูุฎ ุนูุฏ remaining_hours = 0

---

**ุงูุชุงุฑูุฎ:** 2025-10-18  
**ุงูุญุงูุฉ:** ููุฏ ุงูุชูููุฐ  
**ุงูุฃููููุฉ:** ุนุงููุฉ
