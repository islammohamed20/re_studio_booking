# Ù…Ù„Ø®Øµ Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª

## Ø§Ù„ØªØ§Ø±ÙŠØ®: 19 Ø£ÙƒØªÙˆØ¨Ø± 2025

---

## ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©](#1-Ø­Ø³Ø§Ø¨-Ø§Ù„Ù…Ø¨Ù„Øº-Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ-ÙÙŠ-Ø¬Ø¯ÙˆÙ„-Ø®Ø¯Ù…Ø§Øª-Ø§Ù„Ø¨Ø§Ù‚Ø©)
2. [Ø¥Ø¸Ù‡Ø§Ø± Ø­Ù‚ÙˆÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹](#2-Ø¥Ø¸Ù‡Ø§Ø±-Ø­Ù‚ÙˆÙ„-Ù…Ø¹Ù„ÙˆÙ…Ø§Øª-Ø§Ù„Ø¯ÙØ¹)
3. [Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©](#3-Ø­Ø³Ø§Ø¨-Ø³Ø§Ø¹Ø§Øª-Ø§Ù„Ø¨Ø§Ù‚Ø©)
4. [Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± B2B](#4-Ø®ØµÙ…-Ø§Ù„Ù…ØµÙˆØ±-b2b)
5. [Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©](#5-Ø­Ù…Ø§ÙŠØ©-Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª-Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©)
6. [Ø­Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ](#6-Ø­Ù‚Ù„-Ø§Ù„Ù…ÙˆØ¸Ù-Ø§Ù„Ø­Ø§Ù„ÙŠ)

---

## 1. Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©

### ğŸ“ Ø§Ù„Ù…ØªØ·Ù„Ø¨

Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„ÙƒÙ„ ØµÙ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰:

#### **Ø¨Ø¯ÙˆÙ† Ù…ØµÙˆØ± B2B:**
```
amount = quantity Ã— package_price
```

#### **Ù…Ø¹ Ù…ØµÙˆØ± B2B:**
```
amount = quantity Ã— photographer_discount_amount
```

#### **Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ø§Ù‚Ø©:**
```
total_amount_package = Ù…Ø¬Ù…ÙˆØ¹ Ø¬Ù…ÙŠØ¹ amount
```

---

### âœ… Ø§Ù„ØªÙ†ÙÙŠØ°

#### 1. ÙÙŠ `populate_package_services()` - Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø§Ù‚Ø© Ø£ÙˆÙ„ Ù…Ø±Ø©

```python
# Use package price as default, or base price if package price is 0
package_price = flt(getattr(service, 'package_price', 0) or 0)
hourly_rate = package_price if package_price > 0 else base_price

# ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± - Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø®ØµÙˆÙ… Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØµÙˆØ±
photographer_discounted_rate = hourly_rate

if service.service in photographer_services:
	# Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø®ØµÙˆÙ… (discounted_price) Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØµÙˆØ±
	if photographer_services[service.service]['discounted_price'] > 0:
		photographer_discounted_rate = photographer_services[service.service]['discounted_price']
	# Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… Ø§Ù„Ø¹Ø§Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø®Ø¯Ù…Ø© Ù…Ø³Ù…ÙˆØ­ Ø¨Ø®ØµÙ…Ù‡Ø§
	elif photographer_discount > 0 and photographer_services[service.service]['allow_discount']:
		photographer_discounted_rate = hourly_rate * (1 - photographer_discount / 100)

# Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ = Ø§Ù„ÙƒÙ…ÙŠØ© Ã— Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø© (Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ… Ø¥Ù† ÙˆÙØ¬Ø¯)
amt = qty * photographer_discounted_rate

self.append("package_services_table", {
	"service": service.service,
	"service_name": getattr(service, 'service_name', '') or service.service,
	"quantity": qty,
	"base_price": base_price,
	"package_price": hourly_rate,  # Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø§Ù‚Ø© (before photographer discount)
	"photographer_discount_amount": photographer_discounted_rate,  # Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± (per hour)
	"amount": amt,  # Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ = qty Ã— photographer_discounted_rate
	"Ø£Ø¬Ø¨Ø§Ø±ÙŠ": is_mandatory
})
```

#### 2. ÙÙŠ `_build_package_rows()` - Ø¹Ù†Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±

```python
for row in (self.package_services_table or []):
	service_name = getattr(row, 'service', None)
	base_price = float(getattr(row, 'base_price', 0) or getattr(row, 'package_price', 0) or 0)
	row.base_price = base_price
	qty = float(getattr(row, 'quantity', 1) or 1)
	
	# Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ±
	photographer_discounted_rate = base_price
	
	if service_name in photographer_services:
		# Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø®ØµÙˆÙ… Ù…Ù† Ø§Ù„Ù…ØµÙˆØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
		if photographer_services[service_name]['discounted_price'] > 0:
			photographer_discounted_rate = photographer_services[service_name]['discounted_price']
		# ÙˆØ¥Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… Ø§Ù„Ø¹Ø§Ù…Ø©
		elif discount_pct > 0 and service_name in allowed:
			photographer_discounted_rate = base_price * (1 - discount_pct / 100.0)
	
	# ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…
	row.photographer_discount_amount = photographer_discounted_rate  # Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ… (per hour)
	row.amount = photographer_discounted_rate * qty  # Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ = qty Ã— discounted_rate
```

#### 3. ÙÙŠ `_aggregate_package_totals()` - Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª

```python
def _aggregate_package_totals(self):
	if self.booking_type != 'Package':
		return
	base_total = 0.0
	final_total = 0.0
	for row in (self.package_services_table or []):
		qty = float(getattr(row, 'quantity', 1) or 1)
		bp = float(getattr(row, 'base_price', 0) or 0)
		base_total += bp * qty  # Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…)
		final_total += float(getattr(row, 'amount', 0) or 0)  # Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
	self.base_amount_package = round(base_total, 2)
	self.total_amount_package = round(final_total, 2)  # ğŸ¯ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…
```

---

### ğŸ¯ Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ

#### Ø¨Ø¯ÙˆÙ† Ù…ØµÙˆØ± B2B:

| Ø§Ù„Ø®Ø¯Ù…Ø© | Ø§Ù„ÙƒÙ…ÙŠØ© | Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø© Ø¨Ø§Ù„Ø¨Ø§Ù‚Ø© | Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± | Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ |
|--------|--------|-------------------|-------------------|-----------------|
| ØªØµÙˆÙŠØ± | 3 | 500 | 500 | **1,500** |
| Ù…ÙˆÙ†ØªØ§Ø¬ | 2 | 300 | 300 | **600** |
| **Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ** | | | | **2,100** |

#### Ù…Ø¹ Ù…ØµÙˆØ± B2B (Ø®ØµÙ… 20%):

| Ø§Ù„Ø®Ø¯Ù…Ø© | Ø§Ù„ÙƒÙ…ÙŠØ© | Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø© Ø¨Ø§Ù„Ø¨Ø§Ù‚Ø© | Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± | Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ |
|--------|--------|-------------------|-------------------|-----------------|
| ØªØµÙˆÙŠØ± | 3 | 500 | 400 (Ø®ØµÙ… 20%) | **1,200** |
| Ù…ÙˆÙ†ØªØ§Ø¬ | 2 | 300 | 300 (Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø®ØµÙ…) | **600** |
| **Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ** | | | | **1,800** |

---

## 2. Ø¥Ø¸Ù‡Ø§Ø± Ø­Ù‚ÙˆÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹

### ğŸ“ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©

Ø­Ù‚ÙˆÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹ (payment_methodØŒ deposit_amountØŒ paid_amount) Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¬Ø² Package.

### âœ… Ø§Ù„Ø­Ù„

Ø¥Ø²Ø§Ù„Ø© `depends_on` Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„ØªØ¸Ù‡Ø± ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª:

```json
{
  "bold": 1,
  "fieldname": "deposit_amount",
  "fieldtype": "Currency",
  "in_list_view": 1,
  "label": "Ù…Ø¨Ù„Øº Ø§Ù„Ø¹Ø±Ø¨ÙˆÙ† Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²",
  "precision": "2",
  "read_only": 1
  // âœ… Ù„Ø§ ÙŠÙˆØ¬Ø¯ depends_on - ÙŠØ¸Ù‡Ø± ÙÙŠ Service Ùˆ Package
},
{
  "default": "0",
  "fieldname": "paid_amount",
  "fieldtype": "Currency",
  "label": "Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹",
  "precision": "2",
  "reqd": 1
  // âœ… Ù„Ø§ ÙŠÙˆØ¬Ø¯ depends_on - ÙŠØ¸Ù‡Ø± ÙÙŠ Service Ùˆ Package
},
{
  "fieldname": "payment_method",
  "fieldtype": "Link",
  "label": "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹",
  "options": "Payment Method",
  "reqd": 1
  // âœ… Ù„Ø§ ÙŠÙˆØ¬Ø¯ depends_on - ÙŠØ¸Ù‡Ø± ÙÙŠ Service Ùˆ Package
}
```

---

## 3. Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©

### ğŸ“ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª

1. Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø§Ù‚Ø© â†’ ÙƒØªØ§Ø¨Ø© Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© ÙÙŠ Ø­Ù‚Ù„ "Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©"
2. Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ© â†’ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
3. Ø·Ø±Ø­ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
4. Ø¯Ø¹Ù… ØªÙˆØ§Ø±ÙŠØ® Ø­Ø¬Ø² Ù…ØªØ¹Ø¯Ø¯Ø©
5. Ù…Ù†Ø¹ Ø¥Ø¶Ø§ÙØ© ØªÙˆØ§Ø±ÙŠØ® Ø¬Ø¯ÙŠØ¯Ø© Ø¹Ù†Ø¯ Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª
6. Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯ Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª

---

### âœ… Ø§Ù„ØªÙ†ÙÙŠØ°

#### 1. JavaScript - Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ù„Ù„ØµÙ Ø§Ù„ÙˆØ§Ø­Ø¯

```javascript
function calculate_hours_for_row(frm, cdt, cdn) {
	let row = locals[cdt][cdn];
	
	if (row.start_time && row.end_time) {
		// Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ÙˆÙ‚ØªÙŠÙ†
		let start = frappe.datetime.str_to_obj(row.start_time);
		let end = frappe.datetime.str_to_obj(row.end_time);
		
		// Ø¥Ø°Ø§ ÙƒØ§Ù† ÙˆÙ‚Øª Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ø¹Ø¨ÙˆØ± Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„)
		if (end <= start) {
			end.setDate(end.getDate() + 1);
		}
		
		// Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø¨Ø§Ù„Ø³Ø§Ø¹Ø§Øª
		let diff_ms = end - start;
		let hours = diff_ms / (1000 * 60 * 60);
		
		// ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ Ø­Ù‚Ù„ hours Ù„Ù„ØµÙ
		frappe.model.set_value(cdt, cdn, 'hours', hours.toFixed(2));
		
		// Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙˆØ§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
		setTimeout(() => {
			calculate_total_used_hours(frm);
		}, 100);
	}
}
```

#### 2. JavaScript - Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª

```javascript
function calculate_total_used_hours(frm) {
	if (frm.doc.booking_type !== 'Package') {
		return;
	}
	
	// Ø¬Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ù…Ù† Ø¬Ø¯ÙˆÙ„ ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¬Ø²
	let total_used = 0;
	
	if (frm.doc.package_booking_dates && frm.doc.package_booking_dates.length > 0) {
		frm.doc.package_booking_dates.forEach(function(row) {
			if (row.hours) {
				total_used += parseFloat(row.hours);
			}
		});
	}
	
	// ØªØ­Ø¯ÙŠØ« Ø­Ù‚Ù„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
	frm.set_value('used_hours', total_used.toFixed(2));
	
	// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©
	if (frm.doc.package) {
		frappe.db.get_value('Package', frm.doc.package, 'total_hours').then(r => {
			if (r && r.message && r.message.total_hours) {
				let package_total_hours = parseFloat(r.message.total_hours);
				let remaining = package_total_hours - total_used;
				
				// Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† ØµÙØ±
				remaining = Math.max(0, remaining);
				
				// ØªØ­Ø¯ÙŠØ« Ø­Ù‚Ù„ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
				frm.set_value('remaining_hours', remaining.toFixed(2));
				
				// Ø¹Ø±Ø¶ ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø°Ø§ ØªÙ… Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø§Ø¹Ø§Øª
				if (remaining <= 0 && total_used > 0) {
					show_hours_exhausted_alert();
				}
			}
		});
	}
}
```

#### 3. JavaScript - Ù…Ù†Ø¹ Ø¥Ø¶Ø§ÙØ© ØµÙÙˆÙ Ø¹Ù†Ø¯ Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª

```javascript
function check_remaining_hours_before_add(frm) {
	if (frm.doc.booking_type !== 'Package' || !frm.doc.package) {
		return true;
	}
	
	let remaining_hours = parseFloat(frm.doc.remaining_hours || 0);
	
	if (remaining_hours <= 0) {
		// Ø­Ø°Ù Ø§Ù„ØµÙ Ø§Ù„Ø£Ø®ÙŠØ± Ø§Ù„Ù…Ø¶Ø§Ù
		if (frm.doc.package_booking_dates && frm.doc.package_booking_dates.length > 0) {
			let last_row = frm.doc.package_booking_dates[frm.doc.package_booking_dates.length - 1];
			frm.get_field("package_booking_dates").grid.grid_rows_by_docname[last_row.name].remove();
		}
		
		// Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ­Ø°ÙŠØ±
		show_hours_exhausted_alert();
		
		return false;
	}
	return true;
}
```

#### 4. JavaScript - Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡

```javascript
function show_hours_exhausted_alert() {
	frappe.show_alert({
		message: __('âš ï¸ ØªÙ… Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø¬Ù…ÙŠØ¹ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©'),
		indicator: 'red'
	}, 7);
}
```

#### 5. Python - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø§Øª

```python
def compute_package_hours_usage(self):
	try:
		if self.booking_type != 'Package':
			return
		
		# Determine total hours allotted by package
		package_total = 0.0
		if getattr(self, 'package', None):
			package_total = float(frappe.db.get_value('Package', self.package, 'total_hours') or 0)
		
		used = 0.0
		for row in (self.package_booking_dates or []):
			# Derive row.hours if times present
			if getattr(row, 'start_time', None) and getattr(row, 'end_time', None):
				try:
					from datetime import datetime
					fmt = '%H:%M:%S'
					start_str = str(row.start_time)
					end_str = str(row.end_time)
					start_dt = datetime.strptime(start_str, fmt)
					end_dt = datetime.strptime(end_str, fmt)
					# Handle crossing midnight
					if end_dt <= start_dt:
						end_dt = end_dt.replace(day=end_dt.day + 1)
					row.hours = round((end_dt - start_dt).total_seconds() / 3600.0, 2)
				except Exception:
					if not getattr(row, 'hours', None):
						row.hours = 0
			if getattr(row, 'hours', None):
				used += float(row.hours)
		
		self.used_hours = round(used, 2)
		remaining = max(package_total - used, 0.0)
		self.remaining_hours = round(remaining, 2)
		
		# Validation: prevent exceeding package hours
		if package_total > 0 and self.used_hours > package_total:
			excess = self.used_hours - package_total
			if excess > 0.01:  # Ù‡Ø§Ù…Ø´ Ø®Ø·Ø£ 0.01 Ø³Ø§Ø¹Ø©
				frappe.throw(
					msg=f"âš ï¸ ØªÙ… ØªØ¬Ø§ÙˆØ² Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ§Ø­Ø©!<br><br>"
						f"<b>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©:</b> {package_total} Ø³Ø§Ø¹Ø©<br>"
						f"<b>Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</b> {self.used_hours} Ø³Ø§Ø¹Ø©<br>"
						f"<b>Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø¯Ø©:</b> {round(excess, 2)} Ø³Ø§Ø¹Ø©",
					title="Ø®Ø·Ø£ - ØªØ¬Ø§ÙˆØ² Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©"
				)
				
	except Exception as e:
		frappe.log_error(f"compute_package_hours_usage error: {str(e)}")
```

---

## 4. Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± B2B

### ğŸ“ Ø§Ù„Ù…ØªØ·Ù„Ø¨

ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± (Ø¨Ø§Ù‚Ø© Ø«Ù… Ù…ØµÙˆØ± Ø£Ùˆ Ø§Ù„Ø¹ÙƒØ³).

### âœ… Ø§Ù„ØªÙ†ÙÙŠØ°

#### 1. Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ JavaScript

```javascript
function reload_package_services_with_photographer_discount(frm) {
	if (!frm.doc.package) {
		return;
	}
	
	frappe.call({
		method: 're_studio_booking.re_studio_booking.doctype.booking.booking.get_package_services_with_photographer',
		args: {
			package_name: frm.doc.package,
			photographer: frm.doc.photographer || null,
			photographer_b2b: frm.doc.photographer_b2b || 0
		},
		callback: function(r) {
			if (r.message && r.message.services) {
				// Clear existing table
				frm.clear_table('package_services_table');
				
				// Set package total hours to remaining_hours
				if (r.message.total_hours) {
					frm.set_value('remaining_hours', r.message.total_hours);
					frm.set_value('used_hours', 0);
				}
				
				// Add services to table
				r.message.services.forEach(function(service) {
					let row = frm.add_child('package_services_table');
					row.service = service.service;
					row.service_name = service.service_name;
					row.quantity = service.quantity;
					row.base_price = service.base_price;
					row.package_price = service.package_price;
					row.photographer_discount_amount = service.photographer_discount_amount || service.package_price;
					row.amount = service.amount;
					row['Ø£Ø¬Ø¨Ø§Ø±ÙŠ'] = service.is_mandatory || 0;
				});
				
				frm.refresh_field('package_services_table');
				calculate_total_used_hours(frm);
				
				let message = 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­';
				if (frm.doc.photographer && frm.doc.photographer_b2b) {
					message = 'âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©';
				}
				frappe.show_alert({
					message: __(message),
					indicator: 'green'
				}, 3);
			}
		}
	});
}
```

#### 2. ØªØ­Ø¯ÙŠØ« events

```javascript
photographer: function(frm) {
	apply_photographer_discount(frm);
	
	// Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¬Ø² Package ÙˆØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ù‚Ø©ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
	if (frm.doc.booking_type === 'Package' && frm.doc.package) {
		reload_package_services_with_photographer_discount(frm);
	}
},

photographer_b2b: function(frm) {
	apply_photographer_discount(frm);
	
	// Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¬Ø² Package ÙˆØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ù‚Ø©ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
	if (frm.doc.booking_type === 'Package' && frm.doc.package) {
		reload_package_services_with_photographer_discount(frm);
	}
},

package: function(frm) {
	if (frm.doc.package && frm.doc.booking_type === 'Package') {
		reload_package_services_with_photographer_discount(frm);
	}
}
```

#### 3. Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ù„Ø© Python Ø¬Ø¯ÙŠØ¯Ø©

```python
@frappe.whitelist()
def get_package_services_with_photographer(package_name, photographer=None, photographer_b2b=0):
	"""
	Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© Ù…Ø¹ ØªØ·Ø¨ÙŠÙ‚ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
	"""
	# ... Ø§Ù„ÙƒÙˆØ¯ ÙƒØ§Ù…Ù„ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ booking.py
```

---

## 5. Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø©

### ğŸ“ Ø§Ù„Ù…ØªØ·Ù„Ø¨

Ù…Ù†Ø¹ Ø­Ø°Ù Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ = Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (ØªÙ… Ø§Ù„Ø¯ÙØ¹ ÙƒØ§Ù…Ù„Ø§Ù‹)ØŒ Ù…Ø§ Ø¹Ø¯Ø§ Administrator.

### âœ… Ø§Ù„ØªÙ†ÙÙŠØ°

```python
def on_trash(self):
	"""Ù…Ù†Ø¹ Ø­Ø°Ù Ø§Ù„Ø­Ø¬Ø² Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¯ÙÙˆØ¹Ø§Ù‹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø§ Ø¹Ø¯Ø§ Administrator)"""
	self._check_deletion_permission()

def before_cancel(self):
	"""Ù…Ù†Ø¹ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¯ÙÙˆØ¹Ø§Ù‹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ù…Ø§ Ø¹Ø¯Ø§ Administrator)"""
	self._check_deletion_permission()

def _check_deletion_permission(self):
	"""Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø­Ø°Ù/Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø²"""
	# Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ù€ Administrator Ø¨ÙƒÙ„ Ø´ÙŠØ¡
	if frappe.session.user == "Administrator":
		return
	
	# Ø§Ù„ØªØ­Ù‚Ù‚ ÙÙ‚Ø· Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ø®Ø¯Ù…Ø§Øª (Service)
	if self.booking_type != 'Service':
		return
	
	# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ = Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
	paid_amount = flt(getattr(self, 'paid_amount', 0) or 0)
	total_amount = flt(getattr(self, 'total_amount', 0) or 0)
	
	# Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ÙŠØ³Ø§ÙˆÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (ØªÙ… Ø§Ù„Ø¯ÙØ¹ ÙƒØ§Ù…Ù„Ø§Ù‹)
	if paid_amount > 0 and total_amount > 0 and abs(paid_amount - total_amount) < 0.01:
		frappe.throw(
			msg=f"â›” Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø²!<br><br>"
				f"<b>Ø§Ù„Ø³Ø¨Ø¨:</b> ØªÙ… Ø¯ÙØ¹ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„ÙƒØ§Ù…Ù„<br>"
				f"<b>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</b> {total_amount} Ø±ÙŠØ§Ù„<br>"
				f"<b>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹:</b> {paid_amount} Ø±ÙŠØ§Ù„<br><br>"
				f"ÙŠÙ…ÙƒÙ† ÙÙ‚Ø· Ù„Ù€ <b>Administrator</b> Ø­Ø°Ù Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø².",
			title="ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ø§Ù„Ø­Ø°Ù Ø£Ùˆ Ø§Ù„Ø¥Ù„ØºØ§Ø¡"
		)
```

---

## 6. Ø­Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ

### ğŸ“ Ø§Ù„Ù…ØªØ·Ù„Ø¨

Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ ÙŠØ¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ù‡) ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø¹Ø±Ø¶ Ø§Ø³Ù…Ù‡ Ø§Ù„ÙƒØ§Ù…Ù„.

### âœ… Ø§Ù„ØªÙ†ÙÙŠØ°

#### 1. Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ booking.json

```json
{
  "default": "__user",
  "fieldname": "current_employee",
  "fieldtype": "Link",
  "label": "Ø§Ù„Ù…ÙˆØ¸Ù",
  "options": "User",
  "read_only": 1
},
{
  "fetch_from": "current_employee.full_name",
  "fieldname": "current_employee_full_name",
  "fieldtype": "Data",
  "in_list_view": 1,
  "label": "Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„ÙƒØ§Ù…Ù„",
  "read_only": 1
}
```

#### 2. Python - before_save

```python
def before_save(self):
	# ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
	if not self.current_employee:
		self.current_employee = frappe.session.user
	
	# ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯
```

#### 3. JavaScript - refresh

```javascript
refresh: function(frm) {
	// ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
	if (frm.is_new() && !frm.doc.current_employee) {
		frm.set_value('current_employee', frappe.session.user);
	}
	
	// ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯
}
```

---

## ğŸ“Š Ù…Ù„Ø®Øµ Ø´Ø§Ù…Ù„ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª

| # | Ø§Ù„Ù…ÙŠØ²Ø© | Ø§Ù„Ø­Ø§Ù„Ø© | Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© |
|---|--------|--------|-----------------|
| 1 | Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø¨Ø§Ù‚Ø© | âœ… Ù…ÙƒØªÙ…Ù„ | booking.py |
| 2 | Ø¥Ø¸Ù‡Ø§Ø± Ø­Ù‚ÙˆÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹ | âœ… Ù…ÙƒØªÙ…Ù„ | booking.json |
| 3 | Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© | âœ… Ù…ÙƒØªÙ…Ù„ | booking.py, booking.js |
| 4 | Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± B2B | âœ… Ù…ÙƒØªÙ…Ù„ | booking.py, booking.js |
| 5 | Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© | âœ… Ù…ÙƒØªÙ…Ù„ | booking.py |
| 6 | Ø­Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ | âœ… Ù…ÙƒØªÙ…Ù„ | booking.json, booking.py, booking.js |

---

## ğŸ§ª Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±

### âœ… Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø­Ø¬Ø² Ø¨Ø§Ù‚Ø© Ø¨Ø¯ÙˆÙ† Ù…ØµÙˆØ±

1. Ø§Ø®ØªÙŠØ§Ø± Package
2. Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ù‚Ø© (Ù…Ø«Ù„Ø§Ù‹: 10 Ø³Ø§Ø¹Ø§Øª)
3. **Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
   - `remaining_hours` = 10
   - `used_hours` = 0
   - Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙŠØ¸Ù‡Ø±
   - `package_price` = Ø³Ø¹Ø± Ø§Ù„Ø¨Ø§Ù‚Ø©
   - `photographer_discount_amount` = `package_price` (Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…)
   - `amount` = `quantity Ã— package_price`
   - `total_amount_package` = Ù…Ø¬Ù…ÙˆØ¹ `amount`

### âœ… Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø­Ø¬Ø² Ø¨Ø§Ù‚Ø© Ù…Ø¹ Ù…ØµÙˆØ± B2B

1. Ø§Ø®ØªÙŠØ§Ø± Package
2. Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø§Ù‚Ø©
3. Ø§Ø®ØªÙŠØ§Ø± Ù…ØµÙˆØ± B2B
4. ØªÙØ¹ÙŠÙ„ "Photographer B2B"
5. **Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
   - Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ø®ØµÙ…Ù‡Ø§: `photographer_discount_amount` < `package_price`
   - Ø§Ù„Ø®Ø¯Ù…Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ø®ØµÙ…Ù‡Ø§: `photographer_discount_amount` = `package_price`
   - `amount` = `quantity Ã— photographer_discount_amount`
   - `total_amount_package` = Ù…Ø¬Ù…ÙˆØ¹ `amount` Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…

### âœ… Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: Ø¥Ø¶Ø§ÙØ© ØªÙˆØ§Ø±ÙŠØ® Ø­Ø¬Ø²

1. ÙØªØ­ Ø­Ø¬Ø² Package
2. Ø¥Ø¶Ø§ÙØ© ØªØ§Ø±ÙŠØ®: 10:00 - 14:00
3. **Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
   - `hours` = 4
   - `used_hours` = 4
   - `remaining_hours` = 6
4. Ø¥Ø¶Ø§ÙØ© ØªØ§Ø±ÙŠØ® Ø«Ø§Ù†Ù: 15:00 - 18:00
5. **Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
   - `used_hours` = 7
   - `remaining_hours` = 3

### âœ… Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 4: Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª

1. Ø¨Ø§Ù‚Ø© 5 Ø³Ø§Ø¹Ø§Øª
2. Ø¥Ø¶Ø§ÙØ©: 10:00 - 15:00 = 5 Ø³Ø§Ø¹Ø§Øª
3. **Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
   - `remaining_hours` = 0
   - Ø±Ø³Ø§Ù„Ø©: "âš ï¸ ØªÙ… Ø§Ø³ØªÙ†ÙØ§Ø¯ Ø¬Ù…ÙŠØ¹ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø©"
4. Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¬Ø¯ÙŠØ¯
5. **Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
   - ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
   - Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰

### âœ… Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 5: Ø­Ù…Ø§ÙŠØ© Ø­Ø¬Ø² Ù…Ø¯ÙÙˆØ¹

1. Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø¬Ø² Service
2. `total_amount` = 1000
3. `paid_amount` = 1000 (Ø¯ÙØ¹ ÙƒØ§Ù…Ù„)
4. Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­Ø°Ù Ø£Ùˆ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
5. **Ø§Ù„Ù†ØªÙŠØ¬Ø© (ØºÙŠØ± Administrator):**
   - Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£: "â›” Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø²!"
   - Ù…Ù†Ø¹ Ø§Ù„Ø­Ø°Ù/Ø§Ù„Ø¥Ù„ØºØ§Ø¡
6. **Ø§Ù„Ù†ØªÙŠØ¬Ø© (Administrator):**
   - ÙŠÙ…ÙƒÙ† Ø§Ù„Ø­Ø°Ù/Ø§Ù„Ø¥Ù„ØºØ§Ø¡ Ø¨Ø¯ÙˆÙ† Ù‚ÙŠÙˆØ¯

---

## ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù‡Ø§Ù…Ø©

### 1. Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®ØµÙ…

```
1. discounted_price Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØµÙˆØ± (Ø£Ø¹Ù„Ù‰ Ø£ÙˆÙ„ÙˆÙŠØ©)
2. discount_percentage Ø§Ù„Ø¹Ø§Ù…Ø© (Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§)
3. Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø¨Ø¯ÙˆÙ† Ø®ØµÙ…
```

### 2. Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„

| Ø§Ù„Ø­Ù‚Ù„ | Ø§Ù„ÙˆØµÙ |
|------|-------|
| `base_price` | Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Service |
| `package_price` | Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¹Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨Ø§Ù‚Ø© |
| `photographer_discount_amount` | Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± (Ù„ÙƒÙ„ Ø³Ø§Ø¹Ø©) |
| `amount` | Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (quantity Ã— photographer_discount_amount) |

### 3. ØªØ³Ù„Ø³Ù„ Ø§Ù„ØªÙ†ÙÙŠØ°

```
package event â†’ reload_package_services_with_photographer_discount()
                â†“
photographer event â†’ reload_package_services_with_photographer_discount()
                â†“
photographer_b2b event â†’ reload_package_services_with_photographer_discount()
                â†“
validate() â†’ compute_package_hours_usage()
                â†“
validate() â†’ recompute_pricing()
                â†“
_build_package_rows() â†’ _aggregate_package_totals()
```

---

## âœ… Ø§Ù„Ø®Ù„Ø§ØµØ©

Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª ØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ÙˆÙ…ØªÙƒØ§Ù…Ù„:

1. âœ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ (Ø¨Ø¯ÙˆÙ† ÙˆÙ…Ø¹ Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ±)
2. âœ… Ø­Ù‚ÙˆÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹ ØªØ¸Ù‡Ø± ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
3. âœ… Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¨Ø§Ù‚Ø© ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ù…Ù†Ø¹ Ø§Ù„ØªØ¬Ø§ÙˆØ²
4. âœ… Ø®ØµÙ… Ø§Ù„Ù…ØµÙˆØ± B2B ÙŠØ¹Ù…Ù„ Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
5. âœ… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© Ù…Ù† Ø§Ù„Ø­Ø°Ù/Ø§Ù„Ø¥Ù„ØºØ§Ø¡
6. âœ… Ø­Ù‚Ù„ Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

**Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…!** ğŸ‰

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«**: 19 Ø£ÙƒØªÙˆØ¨Ø± 2025  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±**: 2.0  
**Ø§Ù„Ø­Ø§Ù„Ø©**: âœ… Ù…ÙƒØªÙ…Ù„ ÙˆÙ…Ø®ØªØ¨Ø±
